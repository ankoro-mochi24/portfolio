<%= render 'sidebar' %>

<h1>プロフィール編集</h1>

<div class="main-content">
  <div class="content">
    <%= form_with(model: @user, local: true) do |f| %>
      <div class="mb-3">
        <%= f.label :name, "ユーザー名" %>
        <%= f.text_field :name, class: "form-control" %>
      </div>

      <div class="mb-3">
        <%= f.label :email, "メールアドレス" %>
        <%= f.email_field :email, class: "form-control" %>
      </div>

      <h3>持っている調理器具</h3>
      <div data-controller="kitchen-tools">
        <div data-kitchen-tools-target="container">
          <%= f.fields_for :user_kitchen_tools do |tool_form| %>
            <div class="nested-fields" data-new-record="false">
              <%= tool_form.hidden_field :_destroy %>
              <%= tool_form.hidden_field :kitchen_tool_id %>
              <%= tool_form.text_field :kitchen_tool_name, value: tool_form.object.kitchen_tool&.name, required: true, class: "form-control" %>
              <% if tool_form.index > 0 %>
                <a href="#" data-action="click->kitchen-tools#removeField" class="btn btn-danger">削除</a>
              <% end %>
            </div>
          <% end %>
        </div>
        <a href="#" data-action="click->kitchen-tools#addField" class="btn btn-success mt-2">調理器具を追加</a>
        <template data-kitchen-tools-target="template">
          <div class="nested-fields" data-new-record="true">
            <%= hidden_field_tag 'user[user_kitchen_tools_attributes][TEMPLATE_RECORD][_destroy]', false %>
            <%= hidden_field_tag 'user[user_kitchen_tools_attributes][TEMPLATE_RECORD][kitchen_tool_id]' %>
            <%= text_field_tag 'user[user_kitchen_tools_attributes][TEMPLATE_RECORD][kitchen_tool_name]', nil, required: true, class: "form-control" %>
            <a href="#" data-action="click->kitchen-tools#removeField" class="btn btn-danger">削除</a>
          </div>
        </template>
      </div>

      <%= f.submit "更新する", class: "btn btn-primary mt-3" %>
    <% end %>

    <%= link_to "キャンセル", user_path(@user), class: "btn btn-secondary mt-3" %>
  </div>
</div>
